2021-04-27 08:27:04,362 - INFO - Log directory: ./trafficdl/log
2021-04-27 08:27:04,362 - INFO - Begin pipeline, task=traffic_state_pred, model_name=STAGGCN, dataset_name=METR_LA
2021-04-27 08:27:05,796 - INFO - Loaded file METR_LA.geo, num_nodes=207
2021-04-27 08:27:05,858 - INFO - Loaded file METR_LA.rel, shape=(207, 207)
2021-04-27 08:27:05,858 - INFO - Start Calculate the weight by Gauss kernel!
2021-04-27 08:27:05,931 - INFO - Loading ./trafficdl/cache/dataset_cache/point_based_METR_LA_12_12_0.7_0.1_standard_64_False_False_True.npz
2021-04-27 08:27:09,174 - INFO - train	x: (23974, 12, 207, 1)y: (23974, 12, 207, 1)
2021-04-27 08:27:09,175 - INFO - eval	x: (3425, 12, 207, 1)y: (3425, 12, 207, 1)
2021-04-27 08:27:09,175 - INFO - test	x: (6850, 12, 207, 1)y: (6850, 12, 207, 1)
2021-04-27 08:27:09,549 - INFO - StandardScaler mean: 54.40592829587626, std: 19.493739270573094
2021-04-27 08:27:20,252 - INFO - model.STCell.sp_source_embed	torch.Size([207, 12])	cuda:0	True
2021-04-27 08:27:20,252 - INFO - model.STCell.sp_target_embed	torch.Size([12, 207])	cuda:0	True
2021-04-27 08:27:20,253 - INFO - model.STCell.dtw_source_embed	torch.Size([207, 12])	cuda:0	True
2021-04-27 08:27:20,253 - INFO - model.STCell.dtw_target_embed	torch.Size([12, 207])	cuda:0	True
2021-04-27 08:27:20,253 - INFO - model.STCell.seq_linear.weight	torch.Size([12, 12])	cuda:0	True
2021-04-27 08:27:20,253 - INFO - model.STCell.seq_linear.bias	torch.Size([12])	cuda:0	True
2021-04-27 08:27:20,253 - INFO - model.STCell.self_atten.in_proj_weight	torch.Size([621, 207])	cuda:0	True
2021-04-27 08:27:20,253 - INFO - model.STCell.self_atten.in_proj_bias	torch.Size([621])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.self_atten.out_proj.weight	torch.Size([207, 207])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.self_atten.out_proj.bias	torch.Size([207])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.tcn.network.0.conv1.bias	torch.Size([10])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.tcn.network.0.conv1.weight_g	torch.Size([10, 1, 1])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.tcn.network.0.conv1.weight_v	torch.Size([10, 1, 2])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.tcn.network.0.conv2.bias	torch.Size([10])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.tcn.network.0.conv2.weight_g	torch.Size([10, 1, 1])	cuda:0	True
2021-04-27 08:27:20,254 - INFO - model.STCell.tcn.network.0.conv2.weight_v	torch.Size([10, 10, 2])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.tcn.network.0.downsample.weight	torch.Size([10, 1, 1])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.tcn.network.0.downsample.bias	torch.Size([10])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.tlinear.weight	torch.Size([32, 120])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.tlinear.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.sp_origin.weight	torch.Size([32, 12])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.sp_origin.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.sp_gconv1.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.sp_gconv1.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,255 - INFO - model.STCell.sp_gconv1.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv1.lin_l.weight	torch.Size([96, 12])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv2.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv2.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv2.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv2.lin_l.weight	torch.Size([96, 32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv3.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv3.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,256 - INFO - model.STCell.sp_gconv3.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_gconv3.lin_l.weight	torch.Size([96, 32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_gconv4.att_l	torch.Size([1, 1, 32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_gconv4.att_r	torch.Size([1, 1, 32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_gconv4.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_gconv4.lin_l.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_linear_1.weight	torch.Size([32, 12])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_linear_1.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_linear_2.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,257 - INFO - model.STCell.sp_linear_2.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.sp_linear_3.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.sp_linear_3.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.sp_linear_4.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.sp_linear_4.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.dtw_origin.weight	torch.Size([32, 12])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.dtw_origin.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.dtw_gconv1.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.dtw_gconv1.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,258 - INFO - model.STCell.dtw_gconv1.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv1.lin_l.weight	torch.Size([96, 12])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv2.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv2.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv2.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv2.lin_l.weight	torch.Size([96, 32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv3.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv3.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv3.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,259 - INFO - model.STCell.dtw_gconv3.lin_l.weight	torch.Size([96, 32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_gconv4.att_l	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_gconv4.att_r	torch.Size([1, 3, 32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_gconv4.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_gconv4.lin_l.weight	torch.Size([96, 32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_linear_1.weight	torch.Size([32, 12])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_linear_1.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_linear_2.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,260 - INFO - model.STCell.dtw_linear_2.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,261 - INFO - model.STCell.dtw_linear_3.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,261 - INFO - model.STCell.dtw_linear_3.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,261 - INFO - model.STCell.dtw_linear_4.weight	torch.Size([32, 32])	cuda:0	True
2021-04-27 08:27:20,261 - INFO - model.STCell.dtw_linear_4.bias	torch.Size([32])	cuda:0	True
2021-04-27 08:27:20,261 - INFO - model.output_linear.weight	torch.Size([12, 96])	cuda:0	True
2021-04-27 08:27:20,261 - INFO - model.output_linear.bias	torch.Size([12])	cuda:0	True
2021-04-27 08:27:20,262 - INFO - Total parameter numbers: 215984
2021-04-27 08:27:20,269 - INFO - Loaded model at 499
2021-04-27 08:27:20,270 - INFO - Start training ...
2021-04-27 08:27:20,271 - INFO - num_batches:375
2021-04-27 08:27:38,719 - INFO - epoch complete!
2021-04-27 08:27:38,720 - INFO - evaluating now!
2021-04-27 08:27:40,138 - INFO - Epoch [499/1000] train_loss: 4.2322, val_loss: 4.2575, lr: 0.000100, 19.9s
2021-04-27 08:27:40,145 - INFO - Saved model at 499
2021-04-27 08:27:40,146 - INFO - Val loss decrease from inf to 4.2575, saving to ./trafficdl/cache/model_cache/STAGGCN_METR_LA_epoch499.tar
2021-04-27 08:27:57,657 - INFO - epoch complete!
2021-04-27 08:27:57,657 - INFO - evaluating now!
2021-04-27 08:27:59,075 - INFO - Epoch [500/1000] train_loss: 4.2321, val_loss: 4.2611, lr: 0.000100, 18.9s
2021-04-27 08:28:17,122 - INFO - epoch complete!
2021-04-27 08:28:17,122 - INFO - evaluating now!
2021-04-27 08:28:18,539 - INFO - Epoch [501/1000] train_loss: 4.2310, val_loss: 4.2569, lr: 0.000100, 19.5s
2021-04-27 08:28:18,547 - INFO - Saved model at 501
2021-04-27 08:28:18,547 - INFO - Val loss decrease from 4.2575 to 4.2569, saving to ./trafficdl/cache/model_cache/STAGGCN_METR_LA_epoch501.tar
2021-04-27 08:28:36,490 - INFO - epoch complete!
2021-04-27 08:28:36,491 - INFO - evaluating now!
2021-04-27 08:28:37,888 - INFO - Epoch [502/1000] train_loss: 4.2300, val_loss: 4.2571, lr: 0.000100, 19.3s
2021-04-27 08:28:55,431 - INFO - epoch complete!
2021-04-27 08:28:55,432 - INFO - evaluating now!
2021-04-27 08:28:56,789 - INFO - Epoch [503/1000] train_loss: 4.2307, val_loss: 4.2600, lr: 0.000100, 18.9s
2021-04-27 08:29:14,641 - INFO - epoch complete!
2021-04-27 08:29:14,642 - INFO - evaluating now!
2021-04-27 08:29:16,227 - INFO - Epoch [504/1000] train_loss: 4.2284, val_loss: 4.2554, lr: 0.000100, 19.4s
2021-04-27 08:29:16,239 - INFO - Saved model at 504
2021-04-27 08:29:16,239 - INFO - Val loss decrease from 4.2569 to 4.2554, saving to ./trafficdl/cache/model_cache/STAGGCN_METR_LA_epoch504.tar
2021-04-27 08:29:34,493 - INFO - epoch complete!
2021-04-27 08:29:34,494 - INFO - evaluating now!
2021-04-27 08:29:35,860 - INFO - Epoch [505/1000] train_loss: 4.2299, val_loss: 4.2595, lr: 0.000100, 19.6s
2021-04-27 08:29:53,179 - INFO - epoch complete!
2021-04-27 08:29:53,179 - INFO - evaluating now!
2021-04-27 08:29:54,628 - INFO - Epoch [506/1000] train_loss: 4.2272, val_loss: 4.2563, lr: 0.000100, 18.8s
2021-04-27 08:30:12,380 - INFO - epoch complete!
2021-04-27 08:30:12,380 - INFO - evaluating now!
2021-04-27 08:30:13,778 - INFO - Epoch [507/1000] train_loss: 4.2276, val_loss: 4.2551, lr: 0.000100, 19.1s
2021-04-27 08:30:13,785 - INFO - Saved model at 507
2021-04-27 08:30:13,785 - INFO - Val loss decrease from 4.2554 to 4.2551, saving to ./trafficdl/cache/model_cache/STAGGCN_METR_LA_epoch507.tar
2021-04-27 08:30:31,424 - INFO - epoch complete!
2021-04-27 08:30:31,425 - INFO - evaluating now!
2021-04-27 08:30:32,838 - INFO - Epoch [508/1000] train_loss: 4.2269, val_loss: 4.2506, lr: 0.000100, 19.1s
2021-04-27 08:30:32,847 - INFO - Saved model at 508
2021-04-27 08:30:32,847 - INFO - Val loss decrease from 4.2551 to 4.2506, saving to ./trafficdl/cache/model_cache/STAGGCN_METR_LA_epoch508.tar
2021-04-27 08:30:51,291 - INFO - epoch complete!
2021-04-27 08:30:51,291 - INFO - evaluating now!
2021-04-27 08:30:52,829 - INFO - Epoch [509/1000] train_loss: 4.2271, val_loss: 4.2565, lr: 0.000100, 20.0s
2021-04-27 08:31:13,137 - INFO - epoch complete!
2021-04-27 08:31:13,138 - INFO - evaluating now!
2021-04-27 08:31:14,703 - INFO - Epoch [510/1000] train_loss: 4.2269, val_loss: 4.2583, lr: 0.000100, 21.9s
2021-04-27 08:31:34,371 - INFO - epoch complete!
2021-04-27 08:31:34,372 - INFO - evaluating now!
2021-04-27 08:31:36,223 - INFO - Epoch [511/1000] train_loss: 4.2252, val_loss: 4.2521, lr: 0.000100, 21.5s
2021-04-27 08:31:57,020 - INFO - epoch complete!
2021-04-27 08:31:57,021 - INFO - evaluating now!
2021-04-27 08:31:58,825 - INFO - Epoch [512/1000] train_loss: 4.2247, val_loss: 4.2523, lr: 0.000100, 22.6s
2021-04-27 08:32:19,282 - INFO - epoch complete!
2021-04-27 08:32:19,283 - INFO - evaluating now!
2021-04-27 08:32:21,122 - INFO - Epoch [513/1000] train_loss: 4.2253, val_loss: 4.2509, lr: 0.000100, 22.3s
2021-04-27 08:32:41,360 - INFO - epoch complete!
2021-04-27 08:32:41,361 - INFO - evaluating now!
2021-04-27 08:32:43,097 - INFO - Epoch [514/1000] train_loss: 4.2247, val_loss: 4.2515, lr: 0.000100, 22.0s
2021-04-27 08:33:05,081 - INFO - epoch complete!
2021-04-27 08:33:05,082 - INFO - evaluating now!
2021-04-27 08:33:06,987 - INFO - Epoch [515/1000] train_loss: 4.2226, val_loss: 4.2568, lr: 0.000100, 23.9s
2021-04-27 08:33:27,928 - INFO - epoch complete!
2021-04-27 08:33:27,929 - INFO - evaluating now!
2021-04-27 08:33:29,924 - INFO - Epoch [516/1000] train_loss: 4.2227, val_loss: 4.2475, lr: 0.000100, 22.9s
2021-04-27 08:33:29,931 - INFO - Saved model at 516
2021-04-27 08:33:29,932 - INFO - Val loss decrease from 4.2506 to 4.2475, saving to ./trafficdl/cache/model_cache/STAGGCN_METR_LA_epoch516.tar
