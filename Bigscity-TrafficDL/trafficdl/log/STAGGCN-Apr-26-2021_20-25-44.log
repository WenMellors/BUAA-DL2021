2021-04-26 20:25:44,249 - INFO - Log directory: ./trafficdl/log
2021-04-26 20:25:44,249 - INFO - Begin pipeline, task=traffic_state_pred, model_name=STAGGCN, dataset_name=PEMS_BAY
2021-04-26 20:25:45,683 - INFO - Loaded file PEMS_BAY.geo, num_nodes=325
2021-04-26 20:25:45,724 - INFO - Loaded file PEMS_BAY.rel, shape=(325, 325)
2021-04-26 20:25:45,724 - INFO - Start Calculate the weight by Gauss kernel!
2021-04-26 20:25:46,073 - INFO - Loading ./trafficdl/cache/dataset_cache/point_based_PEMS_BAY_12_12_0.7_0.1_standard_64_False_False_True.npz
2021-04-26 20:26:07,434 - INFO - train	x: (36465, 12, 325, 1)y: (36465, 12, 325, 1)
2021-04-26 20:26:07,435 - INFO - eval	x: (5209, 12, 325, 1)y: (5209, 12, 325, 1)
2021-04-26 20:26:07,435 - INFO - test	x: (10419, 12, 325, 1)y: (10419, 12, 325, 1)
2021-04-26 20:26:12,416 - INFO - StandardScaler mean: 62.73567651594296, std: 9.438173664359947
2021-04-26 20:26:56,977 - INFO - model.STCell.sp_source_embed	torch.Size([325, 12])	cuda:3	True
2021-04-26 20:26:56,978 - INFO - model.STCell.sp_target_embed	torch.Size([12, 325])	cuda:3	True
2021-04-26 20:26:56,980 - INFO - model.STCell.dtw_source_embed	torch.Size([325, 12])	cuda:3	True
2021-04-26 20:26:56,981 - INFO - model.STCell.dtw_target_embed	torch.Size([12, 325])	cuda:3	True
2021-04-26 20:26:56,982 - INFO - model.STCell.seq_linear.weight	torch.Size([12, 12])	cuda:3	True
2021-04-26 20:26:56,983 - INFO - model.STCell.seq_linear.bias	torch.Size([12])	cuda:3	True
2021-04-26 20:26:56,984 - INFO - model.STCell.self_atten.in_proj_weight	torch.Size([975, 325])	cuda:3	True
2021-04-26 20:26:56,985 - INFO - model.STCell.self_atten.in_proj_bias	torch.Size([975])	cuda:3	True
2021-04-26 20:26:56,986 - INFO - model.STCell.self_atten.out_proj.weight	torch.Size([325, 325])	cuda:3	True
2021-04-26 20:26:56,987 - INFO - model.STCell.self_atten.out_proj.bias	torch.Size([325])	cuda:3	True
2021-04-26 20:26:56,988 - INFO - model.STCell.tcn.network.0.conv1.bias	torch.Size([10])	cuda:3	True
2021-04-26 20:26:56,989 - INFO - model.STCell.tcn.network.0.conv1.weight_g	torch.Size([10, 1, 1])	cuda:3	True
2021-04-26 20:26:56,989 - INFO - model.STCell.tcn.network.0.conv1.weight_v	torch.Size([10, 1, 2])	cuda:3	True
2021-04-26 20:26:56,989 - INFO - model.STCell.tcn.network.0.conv2.bias	torch.Size([10])	cuda:3	True
2021-04-26 20:26:56,989 - INFO - model.STCell.tcn.network.0.conv2.weight_g	torch.Size([10, 1, 1])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.tcn.network.0.conv2.weight_v	torch.Size([10, 10, 2])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.tcn.network.0.downsample.weight	torch.Size([10, 1, 1])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.tcn.network.0.downsample.bias	torch.Size([10])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.tlinear.weight	torch.Size([32, 120])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.tlinear.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.sp_origin.weight	torch.Size([32, 12])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.sp_origin.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,990 - INFO - model.STCell.sp_gconv1.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv1.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv1.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv1.lin_l.weight	torch.Size([96, 12])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv2.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv2.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv2.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv2.lin_l.weight	torch.Size([96, 32])	cuda:3	True
2021-04-26 20:26:56,991 - INFO - model.STCell.sp_gconv3.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv3.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv3.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv3.lin_l.weight	torch.Size([96, 32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv4.att_l	torch.Size([1, 1, 32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv4.att_r	torch.Size([1, 1, 32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv4.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,992 - INFO - model.STCell.sp_gconv4.lin_l.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_1.weight	torch.Size([32, 12])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_1.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_2.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_2.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_3.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_3.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_4.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.sp_linear_4.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,993 - INFO - model.STCell.dtw_origin.weight	torch.Size([32, 12])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_origin.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv1.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv1.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv1.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv1.lin_l.weight	torch.Size([96, 12])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv2.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv2.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,994 - INFO - model.STCell.dtw_gconv2.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv2.lin_l.weight	torch.Size([96, 32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv3.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv3.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv3.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv3.lin_l.weight	torch.Size([96, 32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv4.att_l	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv4.att_r	torch.Size([1, 3, 32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv4.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,995 - INFO - model.STCell.dtw_gconv4.lin_l.weight	torch.Size([96, 32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_1.weight	torch.Size([32, 12])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_1.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_2.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_2.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_3.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_3.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_4.weight	torch.Size([32, 32])	cuda:3	True
2021-04-26 20:26:56,996 - INFO - model.STCell.dtw_linear_4.bias	torch.Size([32])	cuda:3	True
2021-04-26 20:26:56,997 - INFO - model.output_linear.weight	torch.Size([12, 96])	cuda:3	True
2021-04-26 20:26:56,997 - INFO - model.output_linear.bias	torch.Size([12])	cuda:3	True
2021-04-26 20:26:56,998 - INFO - Total parameter numbers: 473224
2021-04-26 20:26:57,306 - INFO - Loaded model at 199
2021-04-26 20:26:57,308 - INFO - Start training ...
2021-04-26 20:26:57,308 - INFO - num_batches:570
